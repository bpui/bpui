/*!
 * bpui popover v0.1.1
 * Copyright (c) 2020 Copyright bpoint.lee@live.com All Rights Reserved.
 * Released under the MIT License.
 */
"use strict";function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var e=t(require("@bpui/libs"));function o(t,e){if(t!==e)throw new TypeError("Cannot instantiate an arrow function")}var r={components:{widget:t(require("@bpui/dialog")).bpWidget},props:{visible:Boolean,mask:{default:!1,type:Boolean},maskClose:{default:!0,type:Boolean},pageClass:String|Array,pageStyle:String|Array|Object,direction:{default:"auto",type:String},trigger:{type:String},bind:{}},data:function(){return{visibleReal:!1,directionData:"auto",offsetTop:0,offsetLeft:0,offsetArrowLeft:null,offsetArrowTop:null,offsetArrowBottom:null,offsetArrowRight:null}},watch:{visible:function(t,e){this.visibleReal!=t&&(this.visibleReal=t,t!=e&&t&&this._show(this.direction))},visibleReal:function(t){this.$emit("update:visible",t)},bind:function(t,e){this._removeEvent(e),this._bindEvent(t)}},beforeMount:function(){this.visibleReal=this.visible},beforeDestroy:function(){$("body").off("click",this._hide)},mounted:function(){var t=this;this.$nextTick(function(){o(this,t),this.$parent.$forceUpdate()}.bind(this))},methods:{show:function(){return this.$refs.widget.show()},hide:function(){return this.$refs.widget.hide()},_removeEvent:function(t){var o;t&&(o=e.dom.isVueObject(t)?t.$el:t,$(o).off("mouseover",this._onTrigger),$(o).off("mouseleave",this._onTriggerHide),$(o).off("click",this._onTrigger))},_bindEvent:function(t){var o;if((this._removeEvent(t),t)&&(o=e.dom.isVueObject(t)?t.$el:t,"hover"==this.trigger&&(e.device.browserIsMobile()?$(o).on("click",this._onTrigger):($(o).on("mouseover",this._onTrigger),$(o).on("mouseleave",this._onTriggerHide))),"click"==this.trigger)){var r=(e.device.browserIsMobile(),"click");$(o).off(r,this._onTrigger).on(r,this._onTrigger)}},_onTrigger:function(t){var e=this;this.visibleReal=!0,setTimeout(function(){o(this,e),$("body").off("click",this._hide).on("click",this._hide)}.bind(this),10),this._show(this.direction)},_onTriggerHide:function(t){this.visibleReal=!1,$("body").off("click",this._hide)},_show:function(t){var r=this,n=this.bind;if(this.bind){var i;i=e.dom.isVueObject(n)?n.$el:n;var f=e.dom.getElementOffset(i),s={};s.height=i.clientHeight,s.width=i.clientWidth;var c,a=e.dom.getViewPort(),u=e.dom.getDocumentOffset();this.offsetTop=f.top+u.top,"top"==t?(this.directionData="top",this.offsetTop-=s.height,this.offsetTop-=8):"bottom"==t?(this.directionData="bottom",this.offsetTop+=s.height):"left"==t?(this.directionData="left",this.offsetLeft=f.left+s.width):"right"==t?(this.directionData="right",this.offsetLeft=f.left+s.width):f.top+s.height/2>a.height/2?(this.directionData="top",this.offsetTop-=s.height,this.offsetTop-=8):(this.directionData="bottom",this.offsetTop+=s.height),this.offsetTop=parseInt(this.offsetTop),this.offsetTop+="px",c="left"==t||"right"==t?parseInt(f.top+s.height/2):parseInt(f.left+s.width/2);var l=this.$refs.main;e.dom.probeDom(400,function(){return o(this,r),l.clientWidth>0}.bind(this),function(){if(o(this,r),"left"==t||"right"==t){var e=parseInt(c-l.clientHeight/2);e<10&&(e=10),e+l.clientHeight>a.height-10&&(e=a.height-10-l.clientHeight),this.offsetTop=parseInt(e+u.top)+"px",this.offsetLeft="right"==t?f.left+s.width-6:f.left-l.clientWidth-6,this.offsetLeft+=u.left,this.offsetLeft=parseInt(this.offsetLeft),this.offsetLeft+="px",this.offsetArrowLeft=null,this.offsetArrowBottom=null,this.offsetArrowTop=parseInt(c-e-6),this.offsetArrowTop<10?this.offsetArrowTop=10:this.offsetArrowTop>l.clientHeight-22&&(this.offsetArrowTop=parseInt(l.clientHeight-22)),this.offsetArrowTop+="px",this.offsetArrowRight=null}else{var n=parseInt(l.clientWidth||50),i=parseInt(c-n/2);i<10&&(i=10),i+n>a.width-10&&(i=a.width-10-n),this.offsetLeft=parseInt(i)+"px",this.offsetArrowLeft=parseInt(c-i)-6,this.offsetArrowLeft<10?this.offsetArrowLeft=10:this.offsetArrowLeft>n-22&&(this.offsetArrowLeft=n-22),this.offsetArrowLeft+="px",this.offsetArrowBottom=null,this.offsetArrowTop=null,this.offsetArrowRight=null}}.bind(this))}},_hide:function(){var t=this;$("body").off("click",this._hide),this.hide().then(function(e){o(this,t)}.bind(this))}}},n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function i(t,e){return t(e={exports:{}},e.exports),e.exports}var f=function(t){return t&&t.Math==Math&&t},s=f("object"==typeof globalThis&&globalThis)||f("object"==typeof window&&window)||f("object"==typeof self&&self)||f("object"==typeof n&&n)||Function("return this")(),c=function(t){try{return!!t()}catch(t){return!0}},a=!c((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),u={}.propertyIsEnumerable,l=Object.getOwnPropertyDescriptor,h={f:l&&!u.call({1:2},1)?function(t){var e=l(this,t);return!!e&&e.enumerable}:u},p=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},d={}.toString,g=function(t){return d.call(t).slice(8,-1)},v="".split,b=c((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==g(t)?v.call(t,""):Object(t)}:Object,y=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t},m=function(t){return b(y(t))},w=function(t){return"object"==typeof t?null!==t:"function"==typeof t},_=function(t,e){if(!w(t))return t;var o,r;if(e&&"function"==typeof(o=t.toString)&&!w(r=o.call(t)))return r;if("function"==typeof(o=t.valueOf)&&!w(r=o.call(t)))return r;if(!e&&"function"==typeof(o=t.toString)&&!w(r=o.call(t)))return r;throw TypeError("Can't convert object to primitive value")},T={}.hasOwnProperty,S=function(t,e){return T.call(t,e)},A=s.document,O=w(A)&&w(A.createElement),j=!a&&!c((function(){return 7!=Object.defineProperty((t="div",O?A.createElement(t):{}),"a",{get:function(){return 7}}).a;var t})),E=Object.getOwnPropertyDescriptor,x={f:a?E:function(t,e){if(t=m(t),e=_(e,!0),j)try{return E(t,e)}catch(t){}if(S(t,e))return p(!h.f.call(t,e),t[e])}},L=function(t){if(!w(t))throw TypeError(String(t)+" is not an object");return t},C=Object.defineProperty,k={f:a?C:function(t,e,o){if(L(t),e=_(e,!0),L(o),j)try{return C(t,e,o)}catch(t){}if("get"in o||"set"in o)throw TypeError("Accessors not supported");return"value"in o&&(t[e]=o.value),t}},I=a?function(t,e,o){return k.f(t,e,p(1,o))}:function(t,e,o){return t[e]=o,t},R=function(t,e){try{I(s,t,e)}catch(o){s[t]=e}return e},P=s["__core-js_shared__"]||R("__core-js_shared__",{}),M=Function.toString;"function"!=typeof P.inspectSource&&(P.inspectSource=function(t){return M.call(t)});var D,B,H,F,N=P.inspectSource,V=s.WeakMap,W="function"==typeof V&&/native code/.test(N(V)),q=i((function(t){(t.exports=function(t,e){return P[t]||(P[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.6.5",mode:"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"})})),z=0,U=Math.random(),G=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++z+U).toString(36)},X=q("keys"),K={},Y=s.WeakMap;if(W){var J=new Y,Q=J.get,Z=J.has,tt=J.set;D=function(t,e){return tt.call(J,t,e),e},B=function(t){return Q.call(J,t)||{}},H=function(t){return Z.call(J,t)}}else{var et=X[F="state"]||(X[F]=G(F));K[et]=!0,D=function(t,e){return I(t,et,e),e},B=function(t){return S(t,et)?t[et]:{}},H=function(t){return S(t,et)}}var ot,rt,nt={set:D,get:B,has:H,enforce:function(t){return H(t)?B(t):D(t,{})},getterFor:function(t){return function(e){var o;if(!w(e)||(o=B(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return o}}},it=i((function(t){var e=nt.get,o=nt.enforce,r=String(String).split("String");(t.exports=function(t,e,n,i){var f=!!i&&!!i.unsafe,c=!!i&&!!i.enumerable,a=!!i&&!!i.noTargetGet;"function"==typeof n&&("string"!=typeof e||S(n,"name")||I(n,"name",e),o(n).source=r.join("string"==typeof e?e:"")),t!==s?(f?!a&&t[e]&&(c=!0):delete t[e],c?t[e]=n:I(t,e,n)):c?t[e]=n:R(e,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&e(this).source||N(this)}))})),ft=s,st=function(t){return"function"==typeof t?t:void 0},ct=function(t,e){return arguments.length<2?st(ft[t])||st(s[t]):ft[t]&&ft[t][e]||s[t]&&s[t][e]},at=Math.ceil,ut=Math.floor,lt=function(t){return isNaN(t=+t)?0:(t>0?ut:at)(t)},ht=Math.min,pt=function(t){return t>0?ht(lt(t),9007199254740991):0},dt=Math.max,gt=Math.min,vt=function(t){return function(e,o,r){var n,i=m(e),f=pt(i.length),s=function(t,e){var o=lt(t);return o<0?dt(o+e,0):gt(o,e)}(r,f);if(t&&o!=o){for(;f>s;)if((n=i[s++])!=n)return!0}else for(;f>s;s++)if((t||s in i)&&i[s]===o)return t||s||0;return!t&&-1}},bt={includes:vt(!0),indexOf:vt(!1)}.indexOf,yt=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"].concat("length","prototype"),mt={f:Object.getOwnPropertyNames||function(t){return function(t,e){var o,r=m(t),n=0,i=[];for(o in r)!S(K,o)&&S(r,o)&&i.push(o);for(;e.length>n;)S(r,o=e[n++])&&(~bt(i,o)||i.push(o));return i}(t,yt)}},wt={f:Object.getOwnPropertySymbols},_t=ct("Reflect","ownKeys")||function(t){var e=mt.f(L(t)),o=wt.f;return o?e.concat(o(t)):e},Tt=function(t,e){for(var o=_t(e),r=k.f,n=x.f,i=0;i<o.length;i++){var f=o[i];S(t,f)||r(t,f,n(e,f))}},St=/#|\.prototype\./,At=function(t,e){var o=$t[Ot(t)];return o==Et||o!=jt&&("function"==typeof e?c(e):!!e)},Ot=At.normalize=function(t){return String(t).replace(St,".").toLowerCase()},$t=At.data={},jt=At.NATIVE="N",Et=At.POLYFILL="P",xt=At,Lt=x.f,Ct=Array.isArray||function(t){return"Array"==g(t)},kt=function(t){return Object(y(t))},It=function(t,e,o){var r=_(e);r in t?k.f(t,r,p(0,o)):t[r]=o},Rt=!!Object.getOwnPropertySymbols&&!c((function(){return!String(Symbol())})),Pt=Rt&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Mt=q("wks"),Dt=s.Symbol,Bt=Pt?Dt:Dt&&Dt.withoutSetter||G,Ht=function(t){return S(Mt,t)||(Rt&&S(Dt,t)?Mt[t]=Dt[t]:Mt[t]=Bt("Symbol."+t)),Mt[t]},Ft=Ht("species"),Nt=function(t,e){var o;return Ct(t)&&("function"!=typeof(o=t.constructor)||o!==Array&&!Ct(o.prototype)?w(o)&&null===(o=o[Ft])&&(o=void 0):o=void 0),new(void 0===o?Array:o)(0===e?0:e)},Vt=ct("navigator","userAgent")||"",Wt=s.process,qt=Wt&&Wt.versions,zt=qt&&qt.v8;zt?rt=(ot=zt.split("."))[0]+ot[1]:Vt&&(!(ot=Vt.match(/Edge\/(\d+)/))||ot[1]>=74)&&(ot=Vt.match(/Chrome\/(\d+)/))&&(rt=ot[1]);var Ut,Gt=rt&&+rt,Xt=Ht("species"),Kt=Ht("isConcatSpreadable"),Yt=Gt>=51||!c((function(){var t=[];return t[Kt]=!1,t.concat()[0]!==t})),Jt=(Ut="concat",Gt>=51||!c((function(){var t=[];return(t.constructor={})[Xt]=function(){return{foo:1}},1!==t[Ut](Boolean).foo}))),Qt=function(t){if(!w(t))return!1;var e=t[Kt];return void 0!==e?!!e:Ct(t)};function Zt(t,e,o,r,n,i,f,s,c,a){"boolean"!=typeof f&&(c=s,s=f,f=!1);var u,l="function"==typeof o?o.options:o;if(t&&t.render&&(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),r&&(l._scopeId=r),i?(u=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,c(t)),t&&t._registeredComponents&&t._registeredComponents.add(i)},l._ssrRegister=u):e&&(u=f?function(t){e.call(this,a(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,s(t))}),u)if(l.functional){var h=l.render;l.render=function(t,e){return u.call(e),h(t,e)}}else{var p=l.beforeCreate;l.beforeCreate=p?[].concat(p,u):[u]}return o}!function(t,e){var o,r,n,i,f,c=t.target,a=t.global,u=t.stat;if(o=a?s:u?s[c]||R(c,{}):(s[c]||{}).prototype)for(r in e){if(i=e[r],n=t.noTargetGet?(f=Lt(o,r))&&f.value:o[r],!xt(a?r:c+(u?".":"#")+r,t.forced)&&void 0!==n){if(typeof i==typeof n)continue;Tt(i,n)}(t.sham||n&&n.sham)&&I(i,"sham",!0),it(o,r,i,t)}}({target:"Array",proto:!0,forced:!Yt||!Jt},{concat:function(t){var e,o,r,n,i,f=kt(this),s=Nt(f,0),c=0;for(e=-1,r=arguments.length;e<r;e++)if(Qt(i=-1===e?f:arguments[e])){if(c+(n=pt(i.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(o=0;o<n;o++,c++)o in i&&It(s,c,i[o])}else{if(c>=9007199254740991)throw TypeError("Maximum allowed index exceeded");It(s,c++,i)}return s.length=c,s}});var te=r,ee=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("widget",{ref:"widget",staticClass:"bp-popover",attrs:{visible:t.visibleReal,maskClose:t.maskClose,mask:t.mask,pageClass:t.pageClass,pageStyle:t.pageStyle,preventEvent:!1,hideBodyScroll:!1},on:{"update:visible":function(e){t.visibleReal=e}}},[o("div",{ref:"main",staticClass:"bp-popover__main",style:{left:t.offsetLeft,top:t.offsetTop},attrs:{direction:t.directionData}},[t._t("default"),t._v(" "),o("div",{staticClass:"bp-popover__arrow",style:{left:t.offsetArrowLeft,top:t.offsetArrowTop,right:t.offsetArrowRight,bottom:t.offsetArrowBottom}})],2)])};ee._withStripped=!0;var oe={bpPopover:Zt({render:ee,staticRenderFns:[]},void 0,te,void 0,!1,void 0,!1,void 0,void 0,void 0)};module.exports=oe;
